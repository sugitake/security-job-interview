# Cyber Kill Chain

| No.  |  Step  | Purpose | Adversaries' behavior  |   Security implement   |
|---|---|---|---|---|
| 1.  |  Reconnaissance  |  Identify the targets  | <ul><li>harvest email addresses</li><li>Identify employees on social media networks</li><li>Colloct press releases, contract awards, conference attendee lists</li><li>Discover internet-facing servers</li></ul>  |  <ul><li>Collect website visitor logs for alerting and historical searching.</li><li>Collaborate with web adminitrators to utilize their existing browser analytics.</li><li>Build detections for browsing bahavior unique to reconnaissance.</li><li>Prioritize defenses around particular technologies or people based on recon activity.</li><ul> |
| 2.  |  Weaponization | Prepare the Operation  | <ul><li>Obtain a weaponizer, either in-house or obtain through public or private channels</li><li>For file-based exploits, select "decoy" document to present to the victim</li><li>Select backdoor implant and appropriate command and control infrastructure for operation</li><li>Designate a specific "mission id" and embed in the malware</li><ul>  | <ul><li>Conduct full malware analysis not just what payload it drops, but how it was made</li><li>Build detections for weaponizers - find new campaigns and new payloads only because they reused a weaponizer toolkit</li><li>Anayze timeline of when malware was created relative to when it was used. Old malware is "malware off the shell" but new malware might mean active, tailored operations.</li><li>Collect files and metadata for future analysis</li><li>Determine which weaponizer artifacts are common to which APT campaigns. Are they widely shared or closely held?</li><ul>  |
| 3.  |  Delivery   | Launch the Operation  | <ul><li>Direct against web server</li><li>Malicious email</li><li>Malware on USB stick</li><li>Social media interactions</li><li>"Watering hole" compromised websites</li><ul>  | <ul><li>Analyze delivery medium-understand upstream infrastructure</li><li>Understand targeted servers and people, their roles and responsibilities, what information is available</li><li>Infer intent of adversary based on targeting</li><li>Leverage weaponizer argifacts to detect new malicious payloads at the point of Delivery</li><li>Analyze time of day of when operation began</li><li>Collect email and web logs for forensic reconstruction. Even if an intrusion is detected late, defenders must be able to determine when and how deliver began</li><ul>  |
| 4.  |  Exploitation | Gain Access to Victim  | <ul><li>Software, hardware, or human vulnerability</li><li>Acquire or develop zero day exploit</li><li>Adversary triggered exploits for server-based vulnerabilities</li><li>Victim triggered exploits opening attachment of malicious email</li><li>clicking malicious link</li><ul>  |  <ul><li>User awareness training and email testing for employees.</li><li>Secure coding training for web developers.</li><li>Regular vulnerability scanning and penetration testing.</li><li>Endpoint hardening measures: Restrict admin privilege</li><li>Endpoint hardening measures: Use Microsoft EMET</li><li>Endpoint hardening measures: Custom endpoint rules to block shellcode excution</li><li>Endpoint process auditing to forensically determine origin of exploit</li><ul> |
| 5.  |  Installation | Establish beachhead at the victim  | <ul><li>Install webshell on web server</li><li>Install backdoor/implant on client victim</li><li>Create point of persistence by adding services, AutoRun keys, etc.</li><li>Some adversaries "time stomp" the file to make malware appear it is part of the standard oprating system install.</li><li></li><ul>  | <ul><li>HIPS to alert or block on common installation paths, e.g.RECYCLER </li><li>Understand if malware requires administrator privileges or only user.</li><li>ENdpoint process auditing to discover abnormal file creations</li><li>Extract certificates of any signed executables</li><li>Understand compile time of malware to determine if it is old or new</li><ul>  |
| 6.  |  Command & Control(C2) | Remotely Control the Implants  | <ul><li>Open two way communications channel to C2 infrastructure</li><li>Most common C2 channels are over web, DNS, and email protocols</li><li>C2 infrastructure may be adversary owned or another victim network itself</li><ul>  | <ul><li>Discover C2 infrastructure thorough malware analysis.</li><li>harden network: Consolidate number of internet points of presence</li><li>Harden network: Require proxies for all types of traffic(HTTP, DNS)</li><li>Customize blocks of C2 protocols on web proxies</li><li>Proxy category blocks, including "none" or "uncategorized" domains.</li><li>DNS sink holding and name server poisoning.</li><li>Conduct open source research to discover new adversary C2 infrastructure.</li><ul>  |
| 7.  |  Actions on Objectives | Achieve the Mission's Goal  | <ul><li>Collect user credentials</li><li>Privilege escalation</li><li>Internal reconnaissance</li><li>Lateral movement through environment</li><li>Collect and exfiltrate data</li><li>Destroy systems</li><li>Overwrite or corrupt data</li><li>Surreptitiously modify data</li><ul>  | <ul><li>Establish incident response playbook, including executive engagement and communications plan.</li><li>Detect data exfiltration, lateral movement, unauthorized credential usage.</li><li>Immediate analyst response to all CKC7 alerts.</li><li>Forensic agents pre-deployed to endpoints for rapid triage.</li><li>Network package capture to recreate activity</li><li>Conduct damage assesment with subject matter experts.</li><ul>  |

![image](https://www.lockheedmartin.com/content/dam/lockheed-martin/rms/photo/cyber/THE-CYBER-KILL-CHAIN-body.png.pc-adaptive.1920.medium.png)

# References
- https://www.lockheedmartin.com/content/dam/lockheed-martin/rms/documents/cyber/Gaining_the_Advantage_Cyber_Kill_Chain.pdf